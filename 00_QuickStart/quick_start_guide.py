"""
5åˆ†é˜å¿«é€Ÿå…¥é–€æŒ‡å—
Quick Start Guide - Get Started in 5 Minutes

é€™æ˜¯ä¸€å€‹è¶…å¿«é€Ÿçš„å…¥é–€ç¤ºä¾‹ï¼Œè®“ä½ åœ¨5åˆ†é˜å…§ï¼š
1. åŠ è¼‰æ•¸æ“š
2. è¨“ç·´æ¨¡å‹
3. è©•ä¼°æ€§èƒ½
4. é€²è¡Œé æ¸¬

ç„¶å¾Œä½ å¯ä»¥æ·±å…¥å­¸ç¿’å…¶ä»–è©³ç´°æ•™ç¨‹ï¼
"""

import numpy as np
import pandas as pd
from sklearn.datasets import load_iris
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score, classification_report

print("=" * 70)
print("5åˆ†é˜å¿«é€Ÿå…¥é–€ - æ©Ÿå™¨å­¸ç¿’ç¬¬ä¸€å€‹ç¨‹åº".center(70))
print("=" * 70)

# ============================================================================
# æ­¥é©Ÿ 1ï¼šåŠ è¼‰æ•¸æ“šï¼ˆ10ç§’ï¼‰
# ============================================================================
print("\nã€æ­¥é©Ÿ 1/5ã€‘åŠ è¼‰æ•¸æ“š...")
print("-" * 70)

# ä½¿ç”¨ç¶“å…¸çš„é³¶å°¾èŠ±æ•¸æ“šé›†
iris = load_iris()
X = iris.data  # ç‰¹å¾µï¼ˆèŠ±çš„æ¸¬é‡æ•¸æ“šï¼‰
y = iris.target  # æ¨™ç±¤ï¼ˆèŠ±çš„ç¨®é¡ï¼‰

print(f"âœ“ æ•¸æ“šåŠ è¼‰æˆåŠŸï¼")
print(f"  - æ¨£æœ¬æ•¸é‡ï¼š{len(X)}")
print(f"  - ç‰¹å¾µæ•¸é‡ï¼š{X.shape[1]}")
print(f"  - é¡åˆ¥æ•¸é‡ï¼š{len(np.unique(y))}")
print(f"  - é¡åˆ¥åç¨±ï¼š{', '.join(iris.target_names)}")

# ============================================================================
# æ­¥é©Ÿ 2ï¼šåˆ†å‰²æ•¸æ“šï¼ˆ5ç§’ï¼‰
# ============================================================================
print("\nã€æ­¥é©Ÿ 2/5ã€‘åˆ†å‰²è¨“ç·´é›†å’Œæ¸¬è©¦é›†...")
print("-" * 70)

X_train, X_test, y_train, y_test = train_test_split(
    X, y,
    test_size=0.3,  # 30% ç”¨æ–¼æ¸¬è©¦
    random_state=42  # å›ºå®šéš¨æ©Ÿç¨®å­ï¼Œä¿è­‰çµæœå¯é‡ç¾
)

print(f"âœ“ æ•¸æ“šåˆ†å‰²å®Œæˆï¼")
print(f"  - è¨“ç·´é›†ï¼š{len(X_train)} å€‹æ¨£æœ¬")
print(f"  - æ¸¬è©¦é›†ï¼š{len(X_test)} å€‹æ¨£æœ¬")

# ============================================================================
# æ­¥é©Ÿ 3ï¼šè¨“ç·´æ¨¡å‹ï¼ˆ5ç§’ï¼‰
# ============================================================================
print("\nã€æ­¥é©Ÿ 3/5ã€‘è¨“ç·´æ©Ÿå™¨å­¸ç¿’æ¨¡å‹...")
print("-" * 70)

# ä½¿ç”¨éš¨æ©Ÿæ£®æ—åˆ†é¡å™¨ï¼ˆä¸€å€‹å¼·å¤§ä¸”æ˜“ç”¨çš„ç®—æ³•ï¼‰
model = RandomForestClassifier(
    n_estimators=100,  # 100æ£µæ±ºç­–æ¨¹
    random_state=42
)

# è¨“ç·´æ¨¡å‹ï¼ˆè®“æ¨¡å‹å¾æ•¸æ“šä¸­å­¸ç¿’ï¼‰
model.fit(X_train, y_train)

print(f"âœ“ æ¨¡å‹è¨“ç·´å®Œæˆï¼")
print(f"  - ä½¿ç”¨ç®—æ³•ï¼šéš¨æ©Ÿæ£®æ—ï¼ˆRandom Forestï¼‰")
print(f"  - æ¨¹çš„æ•¸é‡ï¼š100")

# ============================================================================
# æ­¥é©Ÿ 4ï¼šè©•ä¼°æ€§èƒ½ï¼ˆ10ç§’ï¼‰
# ============================================================================
print("\nã€æ­¥é©Ÿ 4/5ã€‘è©•ä¼°æ¨¡å‹æ€§èƒ½...")
print("-" * 70)

# åœ¨æ¸¬è©¦é›†ä¸Šé€²è¡Œé æ¸¬
y_pred = model.predict(X_test)

# è¨ˆç®—æº–ç¢ºç‡
accuracy = accuracy_score(y_test, y_pred)

print(f"âœ“ æ¨¡å‹è©•ä¼°å®Œæˆï¼")
print(f"  - æ¸¬è©¦æº–ç¢ºç‡ï¼š{accuracy * 100:.2f}%")
print(f"  - é€™æ„å‘³è‘—æ¨¡å‹åœ¨ {len(X_test)} å€‹æ¸¬è©¦æ¨£æœ¬ä¸­")
print(f"    æ­£ç¢ºé æ¸¬äº† {int(accuracy * len(X_test))} å€‹ï¼")

# è©³ç´°çš„åˆ†é¡å ±å‘Š
print(f"\nè©³ç´°æ€§èƒ½å ±å‘Šï¼š")
print(classification_report(y_test, y_pred, target_names=iris.target_names))

# ============================================================================
# æ­¥é©Ÿ 5ï¼šå¯¦éš›é æ¸¬ï¼ˆ10ç§’ï¼‰
# ============================================================================
print("\nã€æ­¥é©Ÿ 5/5ã€‘ä½¿ç”¨æ¨¡å‹é€²è¡Œå¯¦éš›é æ¸¬...")
print("-" * 70)

# å‰µå»ºä¸€å€‹æ–°çš„èŠ±çš„æ¸¬é‡æ•¸æ“šï¼ˆæˆ–ä½¿ç”¨æ¸¬è©¦é›†ä¸­çš„æ¨£æœ¬ï¼‰
new_flower = X_test[0:1]  # å–ç¬¬ä¸€å€‹æ¸¬è©¦æ¨£æœ¬

# é€²è¡Œé æ¸¬
prediction = model.predict(new_flower)
probability = model.predict_proba(new_flower)

print(f"âœ“ é æ¸¬å®Œæˆï¼")
print(f"\næ–°èŠ±çš„æ¸¬é‡æ•¸æ“šï¼š")
print(f"  - èŠ±è¼é•·åº¦ï¼š{new_flower[0][0]:.1f} cm")
print(f"  - èŠ±è¼å¯¬åº¦ï¼š{new_flower[0][1]:.1f} cm")
print(f"  - èŠ±ç“£é•·åº¦ï¼š{new_flower[0][2]:.1f} cm")
print(f"  - èŠ±ç“£å¯¬åº¦ï¼š{new_flower[0][3]:.1f} cm")

print(f"\né æ¸¬çµæœï¼š")
print(f"  - é æ¸¬ç¨®é¡ï¼š{iris.target_names[prediction[0]]}")
print(f"  - çœŸå¯¦ç¨®é¡ï¼š{iris.target_names[y_test[0]]}")
print(f"  - é æ¸¬æ­£ç¢ºï¼š{'âœ“ æ˜¯' if prediction[0] == y_test[0] else 'âœ— å¦'}")

print(f"\né æ¸¬æ¦‚ç‡ï¼š")
for i, (name, prob) in enumerate(zip(iris.target_names, probability[0])):
    bar = 'â–ˆ' * int(prob * 50)
    print(f"  {name:15s}: {prob:6.2%} {bar}")

# ============================================================================
# æ­å–œï¼ä½ å·²ç¶“å®Œæˆäº†ç¬¬ä¸€å€‹æ©Ÿå™¨å­¸ç¿’ç¨‹åºï¼
# ============================================================================
print("\n" + "=" * 70)
print("ğŸ‰ æ­å–œï¼ä½ å·²ç¶“å®Œæˆäº†ç¬¬ä¸€å€‹æ©Ÿå™¨å­¸ç¿’ç¨‹åºï¼".center(70))
print("=" * 70)

print("""
ä½ å‰›æ‰å­¸åˆ°äº†ä»€éº¼ï¼Ÿ

1. âœ… å¦‚ä½•åŠ è¼‰æ•¸æ“š
2. âœ… å¦‚ä½•åˆ†å‰²è¨“ç·´é›†å’Œæ¸¬è©¦é›†
3. âœ… å¦‚ä½•è¨“ç·´ä¸€å€‹æ©Ÿå™¨å­¸ç¿’æ¨¡å‹
4. âœ… å¦‚ä½•è©•ä¼°æ¨¡å‹æ€§èƒ½
5. âœ… å¦‚ä½•ä½¿ç”¨æ¨¡å‹é€²è¡Œé æ¸¬

æ¥ä¸‹ä¾†å¯ä»¥åšä»€éº¼ï¼Ÿ

ğŸ“š æ·±å…¥å­¸ç¿’ï¼š
  â†’ 01_Basics/01_introduction.py - äº†è§£æ›´å¤šMLæ¦‚å¿µ
  â†’ 02_SupervisedLearning/ - å­¸ç¿’å„ç¨®ç®—æ³•
  â†’ 07_Projects/ - å¯¦æˆ°é …ç›®ç·´ç¿’

ğŸ”§ æ”¹é€²é€™å€‹ç¨‹åºï¼š
  â†’ å˜—è©¦ä¸åŒçš„ç®—æ³•ï¼ˆSVMã€KNNã€Logistic Regressionï¼‰
  â†’ èª¿æ•´æ¨¡å‹åƒæ•¸ï¼ˆn_estimatorsã€max_depthç­‰ï¼‰
  â†’ ä½¿ç”¨ä¸åŒçš„æ•¸æ“šé›†
  â†’ æ·»åŠ æ•¸æ“šå¯è¦–åŒ–

ğŸ’¡ å°è²¼å£«ï¼š
  â€¢ æ©Ÿå™¨å­¸ç¿’çš„æ ¸å¿ƒæ˜¯ï¼šæ•¸æ“š â†’ æ¨¡å‹ â†’ é æ¸¬
  â€¢ æ°¸é è¦åˆ†å‰²è¨“ç·´é›†å’Œæ¸¬è©¦é›†
  â€¢ æ¸¬è©¦é›†ç”¨ä¾†è©•ä¼°æ¨¡å‹çš„çœŸå¯¦æ€§èƒ½
  â€¢ æº–ç¢ºç‡è¶Šé«˜è¶Šå¥½ï¼Œä½†è¦æ³¨æ„éæ“¬åˆ

ä¸‹ä¸€æ­¥å»ºè­°ï¼š
  é‹è¡Œ 01_Basics/01_introduction.py äº†è§£æ›´å¤šæ¦‚å¿µï¼
""")

print("=" * 70)
print("é–‹å§‹ä½ çš„æ©Ÿå™¨å­¸ç¿’ä¹‹æ—…å§ï¼ ğŸš€".center(70))
print("=" * 70)
